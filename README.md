# 以撒LEVEL2程序化接入实时行情数据源

## 简介
本行情源基于大智慧官方版本(v8)的插件，首先安装365.exe,之后启动并使用购买的官方365账号登录，如果出现弹框错误，重启就可以。
如果服务器列表是空，请优选服务器，耐心等待即可。
默认全市场推送五档数据(level2).
其余LEVEL2数据需要请求订阅，订阅方式请查看开发说明。
其余支持的数据类型有：
### 逐笔成交及委托单明细
### 10档（沪深）
### 千档（深）
### 委托队列（沪深）---沪股买一卖一委托队列，深股千档委托队列。

## 开发使用说明

### 1、需要购买大智慧365收费账号并登陆；

### 2、默认推送全市场沪深A股五档盘口（LEVEL2速度），不需要任何订阅！

### 3、需要订阅的实时数据：
```
逐笔成交（ZBCJ)
逐笔成交委托单（ZBDD,即逐笔大单--是全部的委托单而不是只有大单才有，很多客户很疑惑，这里名字取的有点问题，抱歉）
深圳千档盘口
委托队列（上海买一卖一两档，深圳有10档）
6到10档盘口
```
### 4、订阅方法
#### （1）发送http请求:
```
http://localhost:10010/requestl2?list=SH600000,SH600362,SZ300059
```
list后面可以接多个股票，上限1000只，这是大智慧服务器的限制，不是本软件的限制，请注意，如果超过会收不到任何行情！！	
此请求订阅如果既有上海股票又有深圳股票，则有以下结果：	   所有股票包括上海深圳，分别如下数据：
```
A、上海股票返回逐笔成交及委托单，委托队列，6到10档盘口	  
B、深圳股票返回逐笔成交（没有委托单哦），买一卖一委托队列，6到10档盘口
（这个是推送式行情，但还是建议间隔请求一下防止意外断线等）
```
#### （2）发送http请求
```
http://localhost:10010/requestqx?list=SZ300059,SZ300456	
```
请求深圳股票全息行情，后面只能是深圳股票！！！	
此请求将订阅深圳股票的逐笔成交委托单，千档盘口，千档盘口的委托队列！弥补第一个订阅的其他深圳数据！！	
```
（全息行情是请求式行情，必须一分钟请求一次！！）
```
#### （3）发送http请求
```
http://localhost:10010/requestzbhis?list=SH600465,SH601378
```
（这是推送式当天历史数据！只需要请求一次，除非数据不全，可以重新请求）
#### 总结：以上的http请求可在您自己的程序中实现，也可以在浏览器中完成，请求返回的股票代码列表，表示订阅成功，而不是返回数据!
```
NOTE:requestl2和requestqx可以不同的股票列表，相互不会冲突，也不会覆盖，而是各自收取。
```
#### （4）发送http请求
```
http://localhost:10010/requestqq?S=0&E=300&market=SHQQ-A
```
```
market:上交所:SHQQ-A, 深交所：SZQQ-A
S=0&E=300不用修改，写死即可。
```
（这是推送式上证所股票期权全市场行情！）

### 5、高速UDP模式和TCP模式，推荐使用UDP多线程并发监听端口的数据并处理。
启用UDP模式：
```
修改Dataengine.ini,在[send_conf]组加入udp_port=xxxx, 如果xxxx=0,就不启用UDP;大于0则启用；
```
启用TCP模式：（速度较慢，可能导致丢失数据）
```
修改Dataengine.ini,在[send_conf]组加入tcp_port=xxxx, 如果xxxx=0,就不启用UDP;大于0则启用；
```
原有的ZMQ模式配置维持不变，如果以上两者端口配置都是0，那么沿用ZMQ模式；udp和tcp都配置了的情况，UDP优先。
ZMQ增加PUSH/PULL模式，在send_conf节点下增加zmq_pullmode=1就启用PUSH/PULL,而不是PUB/SUB.
PUSH/PULL可以有多个线程PULL,增加数据获取速度，如果是ZMQ推荐使用PUSH/PULL!!!
### 6、DLL方式接入行情
提供MATESDK.DLL供客户快速接入开发，本DLL仅作为ZMQ PULL方式使用，因此服务器端dataengine.ini应该加一行配置：
```
zmq_pullmode=1
```
